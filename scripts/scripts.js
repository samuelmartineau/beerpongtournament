"use strict";angular.module("beerPongTournamentApp",["ngRoute","LocalStorageModule"]).config(["$routeProvider",function(e){e.when("/",{templateUrl:"views/home.html",controller:"HomeCtrl"}).when("/selectTournament",{templateUrl:"views/selecttournament.html",controller:"SelectTournamentCtrl"}).when("/teamNaming",{templateUrl:"views/teamnaming.html",controller:"TeamNamingCtrl"}).when("/manualTeamNaming",{templateUrl:"views/manualteamnaming.html",controller:"ManualTeamNamingCtrl"}).when("/groups",{templateUrl:"views/groups.html",controller:"GroupsCtrl"}).when("/playoffs/:round",{templateUrl:"views/playoffs.html",controller:"PlayoffsCtrl"}).when("/tables/:showButton",{templateUrl:"views/tables.html",controller:"TablesCtrl"}).when("/winner",{templateUrl:"views/winner.html",controller:"WinnerCtrl"}).when("/scorers",{templateUrl:"views/scorers.html",controller:"ScorersCtrl"}).when("/faq",{templateUrl:"views/faq.html"}).when("/rules",{templateUrl:"views/rules.html"}).when("/history",{templateUrl:"views/history.html"}).otherwise({redirectTo:"/"})}]);
"use strict";angular.module("beerPongTournamentApp").controller("HomeCtrl",["$scope","localStorageService",function(t,e){t.isTournamentPlaying=e.get("tournamentSettings"),t.lastTournamentPath=e.get("tournamentPath")}]);
"use strict";angular.module("beerPongTournamentApp").controller("SelectTournamentCtrl",["$scope","$location","GroupEngine","Tournament","constants",function(e,r,n,a,o){var t,u;a.clearSettings(),e.callAlgo=function(r){t=r,e.showPlayoffs=!1;var a=n.getGroupFromNumberOfPlayers(r);e.groupsSelect=[];for(var u=0,f=a.length;f>u;u++)for(var s=0,p=a[u].configurations.length;p>s;s++)if(a[u].configurations[s].directTournament)e.groupsSelect.push({separator:"team of "+a[u].numberOfPlayers,value:"Tournament from "+o.PLAYOFF_NAME[a[u].configurations[s].step],directTournament:1,step:a[u].configurations[s].step,playersPerTeam:a[u].numberOfPlayers,numberOfTeams:+Math.pow(2,1+a[u].configurations[s].step)});else{var i=[];1===a[u].configurations[s].nbrOfGroups&&i.push({step:-1,value:"simple championship"});for(var m=0,l=a[u].configurations[s].playOffStepMin.length;l>m;m++)i.push({step:a[u].configurations[s].playOffStepMin[m],value:o.PLAYOFF_NAME[a[u].configurations[s].playOffStepMin[m]]});e.groupsSelect.push({separator:"team of "+a[u].numberOfPlayers,playersPerTeam:a[u].numberOfPlayers,value:a[u].configurations[s].nbrOfGroups+" group(s) of "+a[u].configurations[s].nbrOfTeam+" teams",playOffStepMin:a[u].configurations[s].playOffStepMin,playoffs:i,nbrOfGroups:a[u].configurations[s].nbrOfGroups,numberOfTeams:a[u].configurations[s].nbrOfTeam})}},e.getConfigFromNumberOfTeam=function(r){u=r;var a=n.getConfigsFromNumberOfTeams(r);e.configurationsManual=[];for(var t=0,f=a.length;f>t;t++)if(a[t].directTournament)e.configurationsManual.push({value:"Tournament from "+o.PLAYOFF_NAME[a[t].step],directTournament:1,step:a[t].step,numberOfTeams:r});else{var s=[];1===a[t].nbrOfGroups&&s.push({step:-1,value:"simple championship"});for(var p=0,i=a[t].playOffStepMin.length;i>p;p++)s.push({step:a[t].playOffStepMin[p],value:o.PLAYOFF_NAME[a[t].playOffStepMin[p]]});e.configurationsManual.push({value:a[t].nbrOfGroups+" group(s) of "+a[t].nbrOfTeam+" teams",playOffStepMin:a[t].playOffStepMin,playoffs:s,nbrOfGroups:a[t].nbrOfGroups,numberOfTeams:a[t].nbrOfTeam})}},e.goManualTeamNaming=function(e,n,o){a.clearSettings();var t={numberOfGroups:e.nbrOfGroups,numberOfTeamsPerGroup:e.numberOfTeams,playoffStepAfterGroup:n?n.step:void 0,isDirectTournament:e.directTournament,directTournamentStep:e.step,numberOfCupsToWin:o};a.init(t),r.path("/manualTeamNaming")},e.goNextStep=function(e,n,o){var u={numberOfPlayers:t,numberOfGroups:e.nbrOfGroups,numberOfTeamsPerGroup:e.numberOfTeams,numberOfPlayerPerTeam:e.playersPerTeam,playoffStepAfterGroup:n?n.step:void 0,isDirectTournament:e.directTournament,directTournamentStep:e.step,numberOfCupsToWin:o};a.init(u),r.path("/teamNaming")}}]);
"use strict";angular.module("beerPongTournamentApp").controller("TeamNamingCtrl",["$scope","$location","Tournament",function(r,a,e){function t(r){for(var a,e,t=r.length;0!==t;)e=Math.floor(Math.random()*t),t-=1,a=r[t],r[t]=r[e],r[e]=a;return r}var o,s=e.getNumberOfGroups(),n=e.getNumberOfTeamsPerGroup(),m=e.getNumberOfPlayerPerTeam(),p=e.isADirectTournament(),u=[],l=1,f=1;if(p){o={name:"Direct Tournament",teams:[]};for(var h=0;n>h;h++){o.teams.push({name:"Team "+l++,players:[]});for(var g=0;m>g;g++)f++,o.teams[h].players.push({name:"Player "+f,id:f})}u.push(o),r.groups=u}else for(var v=0,c=s;c>v;v++){o={name:"GROUP "+String.fromCharCode(65+v),teams:[]};for(var i=0,y=n;y>i;i++){o.teams.push({name:"Team "+l++,players:[]});for(var T=0,P=m;P>T;T++)o.teams[i].players.push({name:"Player "+f++,id:f})}u.push(o),r.groups=u}r.startTournament=function(){e.setTeams(r.groups),a.path(p?"/playoffs/0":"/groups")},r.switchPlayers=function(r){for(var a=[],e=0,o=r.teams.length;o>e;e++){var s=r.teams[e];a=a.concat(s.players)}t(a);for(var e=0,o=r.teams.length;o>e;e++){var s=r.teams[e];s.players=[];for(var n=0;m>n;n++)s.players.push(a.pop())}},r.random=function(){for(var a=[],e=0,o=u.length;o>e;e++)for(var s=0,n=u[e].teams.length;n>s;s++){var p=u[e].teams[s];a=a.concat(p.players)}t(a);for(var e=0,o=u.length;o>e;e++)for(var s=0,n=u[e].teams.length;n>s;s++){var p=u[e].teams[s];p.players=[];for(var l=0;m>l;l++)p.players.push(a.pop())}r.groups=u},r.switchTeam=function(){for(var a=[],e=0,o=u.length;o>e;e++)a=a.concat(u[e].teams);t(a);for(var e=0,o=u.length;o>e;e++)for(var s=0,n=u[e].teams.length;n>s;s++)u[e].teams[s]=a.pop();r.groups=u}}]);
"use strict";angular.module("beerPongTournamentApp").controller("PlayoffsCtrl",["$scope","$location","$routeParams","Tournament","constants",function(e,r,s,t,a){var n=angular.copy(t.getPlayoffs()),o=t.getNumberOfCupsToWin(),l=s.round,u=n[l].teams.length,c=Math.log(u)/Math.log(2)-1,p=u/2,f=0;if(e.nbrOfCupsToWin=o,e.title=a.PLAYOFF_NAME[c],n[l].result){e.games=n[l].result;for(var h=0,g=n[l].result.length;g>h;h++){var i=n[l].result[h];i.winner>-1&&p--}0===p&&(e.showNextStep=!0)}else{for(var m=angular.copy(n[l].teams),y=[],w=0,P=p;P>w;w++){var v,M,d,N;v=Math.floor(Math.random()*m.length),d=m[v],m.splice(v,1),M=Math.floor(Math.random()*m.length),N=m[M],m.splice(M,1);for(var x=[],T=[],W=d.players.length,b=N.players.length,A=0,C=Math.max(W,b);C>A;A++)W>A&&(d.players[A].score=0,x.push(angular.copy(d.players[A]))),b>A&&(N.players[A].score=0,T.push(angular.copy(N.players[A])));y.push({title:d.name+" vs "+N.name,match:[d,N],score:[0,0],scorers:[x,T],winner:-1,id:f++})}e.games=y}e.setWinner=function(r,s){-1===r.winner&&(p--,0===p&&(e.showNextStep=!0)),r.winner=s,n[l].result=e.games,t.setPlayoffs(n)},e.scoreUp=function(r,s,a){s[a]<o&&(s[a]=s[a]+1,r.score=r.score?r.score+1:1,n[l].result=e.games,t.setPlayoffs(n))},e.scoreDown=function(r,s,a,o){r.score>0&&(o.winner===a&&(o.winner=-1,p++),s[a]=s[a]-1,r.score=r.score-1,n[l].result=e.games,t.setPlayoffs(n))},e.goNextStep=function(){n[l].result=e.games;for(var s=[],a=parseInt(l)+1,u=0,c=n[l].result.length;c>u;u++)s.push(n[l].result[u].score[0]===o?n[l].result[u].match[0]:n[l].result[u].match[1]);n.push({teams:s}),t.setPlayoffs(n),s.length>1?r.path("/playoffs/"+a):(t.setWinner(s[0]),r.path("/winner"))}}]);
"use strict";angular.module("beerPongTournamentApp").controller("GroupsCtrl",["$scope","$location","Tournament",function(r,e,o){function s(r,e,o){for(var s=0,t=r.length;t>s;s++)r[s]=s===e[0]||s===e[1]?0:r[s]+1;for(var n=0,u=o.length;u>n;n++)o[n].priority=r[o[n].match[0]]+r[o[n].match[1]];o.sort(function(r,e){return e.priority-r.priority})}var t=o.getNumberOfCupsToWin(),n=0,u=0;if(r.nbrOfCupsToWin=t,r.showNextStep=!1,o.getGroupsResult()){var p=o.getGroupsResult();r.groups=p;for(var a=0,l=p.length;l>a;a++)for(var h=0,i=p[a].rounds.length;i>h;h++)for(var c=0,g=p[a].rounds[h].length;g>c;c++)p[a].rounds[h][c].winner<0&&n++;0===n&&(r.showNextStep=!0)}else{for(var f=[],v=o.getTeams(),m=0,y=v.length;y>m;m++){for(var w=v[m],G=v[m].teams,d=G.length,R=[],x=[],N=0,T=G.length;T>N;N++)x.push(0);for(var b=1,S=G.length;S>b;b++)for(var C=0;b-1>=C;C++){for(var W=[],M=[],O=G[b].players.length,$=G[C].players.length,h=0,i=Math.max(O,$);i>h;h++)O>h&&(G[b].players[h].score=0,W.push(angular.copy(G[b].players[h]))),$>h&&(G[C].players[h].score=0,M.push(angular.copy(G[C].players[h])));R.push({priority:0,match:[b,C],title:G[b].name+" vs "+G[C].name,score:[0,0],scorers:[W,M],winner:-1,id:u++})}for(n+=R.length,w.rounds=[];R.length>0;){for(var A=[],D=0,P=Math.floor(d/2);P>D;D++){var U=R.shift();A.push(U),s(x,U.match,R)}w.rounds.push(A)}f.push(w)}r.groups=f,o.setGroupsResult(r.groups)}r.setWinner=function(e,s){-1===e.winner&&(n--,0===n&&(r.showNextStep=!0)),e.winner=s,o.setGroupsResult(r.groups)},r.scoreUp=function(e,s,n){s[n]<t&&(s[n]=s[n]+1,e.score=e.score?e.score+1:1,o.setGroupsResult(r.groups))},r.scoreDown=function(e,s,t,u){e.score>0&&(u.winner===t&&(u.winner=-1,n++),s[t]=s[t]-1,e.score=e.score-1,o.setGroupsResult(r.groups))},r.goNextStep=function(){o.setGroupsResult(r.groups),e.path("/tables/1")}}]);
"use strict";angular.module("beerPongTournamentApp").controller("TablesCtrl",["$scope","$routeParams","$location","Tournament",function(e,a,t,r){var o=r.getPlayoffStepAfterGroup(),n=r.getTables(),s=r.getTeams(),f=(r.getPlayoffs(),parseInt(a.showButton));if(e.showButton=f,e.tables=n,o>-1){var l=r.getNumberOfGroups(),u=Math.pow(2,o+1)/l;if(e.numberOfTeamsQualifiedPerGroups=u,f){for(var m=[],p=angular.copy(s),i=0;i<s.length;i++)for(var g=0;u>g;g++)for(var b=p[i].teams.length;b--;)if(p[i].teams[b].name===n[i].table[g].name){m.push(p[i].teams[b]);break}r.SetTeamsQualifiedForPlayoff(m),e.goNextStep=function(){t.path("/playoffs/0")}}}else{e.numberOfTeamsQualifiedPerGroups=1;for(var c=n[0].table[0],p=angular.copy(s),b=p[0].teams.length;b--;)if(p[0].teams[b].name===c.name){r.setWinner(p[0].teams[b]);break}e.goNextStep=function(){t.path("/winner")}}}]);
"use strict";angular.module("beerPongTournamentApp").controller("WinnerCtrl",["$scope","Tournament",function(e,n){e.winner=n.getWinner(),e.scorers=n.getScorers()}]);
"use strict";angular.module("beerPongTournamentApp").controller("HeaderCtrl",["$scope","$location","Tournament","localStorageService",function(e,t,n,o){var a=t.url();e.goTournament=o.get("tournamentPath"),e.isOpen=!1,e.iconActive=-1,"/tables/0"===a?e.iconActive=1:"/scorers"===a?e.iconActive=2:(o.set("tournamentPath","#"+a),e.goTournament="#"+a,e.iconActive=0),e.displayTablesButton=n.getTables(),e.displayScorersButton=n.getTeams(),e.toggleMenu=function(){e.isOpen=!e.isOpen}}]);
"use strict";angular.module("beerPongTournamentApp").controller("ScorersCtrl",["$scope","Tournament",function(e,r){e.scorers=r.getScorers();for(var t=r.getTeams(),a=[],n=[],o=0,s=t.length;s>o;o++){var l=t[o];a.push(l.name);for(var m=0,u=l.teams.length;u>m;m++){var c=l.teams[m];n.push(c.name)}}e.filterTypes=[a,n]}]);
"use strict";angular.module("beerPongTournamentApp").controller("ManualTeamNamingCtrl",["$scope","$location","Tournament",function(e,r,a){var n,s=a.getNumberOfGroups(),m=a.getNumberOfTeamsPerGroup(),o=a.isADirectTournament(),t=[],u=1,p=1,l=1;if(e.playersMinimum=s*m,o){n={name:"Direct Tournament",teams:[]};for(var i=0;m>i;i++)n.teams.push({name:"Team "+u++,players:[]});t.push(n),e.groups=t}else for(var f=0,y=s;y>f;f++){n={name:"GROUP "+String.fromCharCode(65+f),teams:[]};for(var g=0,c=m;c>g;g++)n.teams.push({name:"Team "+u++,players:[]});t.push(n),e.groups=t}e.addPlayer=function(r){0===r.players.length&&e.playersMinimum--,r.players.push({name:"Player "+p++,id:l++})},e.removePlayer=function(r,a){for(var n=r.players.length;n--;)if(r.players[n].id===a.id){r.players.splice(n,1);break}0===r.players.length&&e.playersMinimum++},e.startTournament=function(){a.setTeams(e.groups),r.path(o?"/playoffs/0":"/groups")}}]);
"use strict";angular.module("beerPongTournamentApp").factory("GroupEngine",function(){function r(r){var a=Math.log(r)/Math.log(2);return a===parseInt(a)}function a(a){var o=[];r(a)&&o.push({directTournament:1,step:Math.log(a/2)/Math.log(2)});for(var t=!0,n=0;t;){var u=a/Math.pow(2,n);if(u===parseInt(u)&&u>2){for(var e=Math.pow(2,n),f=a-e,i=Math.floor(Math.log(f)/Math.log(2)),s=Math.pow(2,i),h=!0,p=0,g=[];h;)3>e&&2*Math.pow(2,p)<=s?(g.push(Math.log(Math.pow(2,p))/Math.log(2)),p++):e>2&&e*Math.pow(2,p)<=s?(g.push(Math.log(e*Math.pow(2,p)/2)/Math.log(2)),p++):h=!1;o.push({nbrOfGroups:e,nbrOfTeam:u,playOffStepMin:g}),n++}else t=!1}return o}var o={};return o.getGroupFromNumberOfPlayers=function(r){var o=[];if(r>1){var t={numberOfPlayers:1,configurations:[]};t.configurations=a(r),o.push(t)}if(r%2===0&&r>4){var n={numberOfPlayers:2,configurations:[]};n.configurations=a(r/2),o.push(n)}if(r%3===0&&r>6){var u={numberOfPlayers:3,configurations:[]};u.configurations=a(r/3),o.push(u)}return o},o.getConfigsFromNumberOfTeams=function(r){var o=a(r);return o},o});
"use strict";angular.module("beerPongTournamentApp").service("Tournament",["localStorageService",function(e){function r(e,r,t,n,s){for(var o=e.length;o--;)if(e[o].name===r){"win"===t?e[o].win+=1:"lose"===t&&(e[o].lose+=1),e[o].cupsFor+=n,e[o].cupsAgainst+=s;break}}function t(e,r,t,n){for(var s=e.length;s--;)if(e[s].id===r){e[s].score+=t,e[s].numberOfGame+=1,e[s].win+=+n;break}}var n=e.get("tournamentSettings")||!1,s=e.get("teams")||!1,o=e.get("groupResult")||!1,i=e.get("playoffs")||!1,a=e.get("winner")||!1;this.clearSettings=function(){e.clearAll(),a=n=s=o=i=!1},this.init=function(r){e.set("tournamentSettings",r),n=r},this.isADirectTournament=function(){return n.isDirectTournament},this.getNumberOfGroups=function(){return n.numberOfGroups},this.getDirectTournamentStep=function(){return n.directTournamentStep},this.getNumberOfTeamsPerGroup=function(){return n.numberOfTeamsPerGroup},this.getNumberOfPlayerPerTeam=function(){return n.numberOfPlayerPerTeam},this.setTeams=function(r){s=r,e.set("teams",r)},this.getTeams=function(){return s},this.SetTeamsQualifiedForPlayoff=function(r){i=[{teams:r}],e.set("playoffs",i)},this.setPlayoffs=function(r){e.set("playoffs",r),i=r},this.getPlayoffs=function(){return i?i:[{teams:s[0].teams}]},this.getNumberOfCupsToWin=function(){return n.numberOfCupsToWin},this.getPlayoffStepAfterGroup=function(){return n.playoffStepAfterGroup},this.getGroupsResult=function(){return o},this.setGroupsResult=function(r){e.set("groupResult",r),o=r},this.setWinner=function(r){e.set("winner",r),a=r},this.getWinner=function(){return a},this.getTables=function(){for(var e=[],t=0,n=o.length;n>t;t++){for(var s={name:o[t].name,table:[]},i=0,a=o[t].teams.length;a>i;i++){var u={name:o[t].teams[i].name,win:0,lose:0,cupsFor:0,cupsAgainst:0};s.table.push(u)}for(var f=0,c=o[t].rounds.length;c>f;f++)for(var m=0,l=o[t].rounds[f].length;l>m;m++){var g=o[t].rounds[f][m];if(g.winner>-1){var h=g.winner,p=+!g.winner;r(s.table,o[t].teams[g.match[h]].name,"win",g.score[h],g.score[p]),r(s.table,o[t].teams[g.match[p]].name,"lose",g.score[p],g.score[h])}}s.table.sort(function(e,r){if(r.win===e.win){var t=e.cupsFor-e.cupsAgainst,n=r.cupsFor-r.cupsAgainst;return n===t?e.cupsFor-r.cupsFor:n-t}return r.win-e.win}),e.push(s)}return e},this.getScorers=function(){for(var e=[],r=0,n=s.length;n>r;r++)for(var u=s[r],f=s[r].name,c=0,m=u.teams.length;m>c;c++)for(var l=s[r].teams[c],g=s[r].teams[c].name,h=0,p=l.players.length;p>h;h++){var v=l.players[h];v.score=0,v.numberOfGame=0,v.groupName=f,v.teamName=g,v.win=0,v.winner=a&&a.name===g?1:0,e.push(v)}if(o)for(var r=0,n=o.length;n>r;r++)for(var u=o[r],c=0,m=u.rounds.length;m>c;c++)for(var w=u.rounds[c],h=0,p=w.length;p>h;h++){var b=w[h];if(b.winner>-1)for(var T=b.scorers[0].length,d=b.scorers[1].length,y=0,P=Math.max(T,d);P>y;y++){if(T>y){var S=b.scorers[0][y];t(e,S.id,S.score,0===b.winner)}if(d>y){var G=b.scorers[1][y];t(e,G.id,G.score,1===b.winner)}}}if(i)for(var r=0,n=i.length;n>r;r++){var O=i[r];if(O.result)for(var c=0,m=O.result.length;m>c;c++){var b=O.result[c];if(b.winner>-1)for(var T=b.scorers[0].length,d=b.scorers[1].length,y=0,P=Math.max(T,d);P>y;y++){if(T>y){var S=b.scorers[0][y];t(e,S.id,S.score,0===b.winner)}if(d>y){var G=b.scorers[1][y];t(e,G.id,G.score,1===b.winner)}}}}return e.sort(function(e,r){return r.score-e.score}),e}}]);
"use strict";angular.module("beerPongTournamentApp").constant("constants",{PLAYOFF_NAME:["final","semi-final","quarter-final","16nd round","32nd round","64nd round","128 nd round","256 nd round","512 nd round"]});
"use strict";angular.module("beerPongTournamentApp").filter("scorers",function(){return function(r,e,n){if(0>e||e>-1&&!n)return r;if(0==e){for(var t=[],u=0,o=r.length;o>u;u++)r[u].groupName===n&&t.push(r[u]);return t}for(var t=[],u=0,o=r.length;o>u;u++)r[u].teamName===n&&t.push(r[u]);return t}});