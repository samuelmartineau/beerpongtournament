"use strict";angular.module("beerPongTournamentApp",["ngRoute","LocalStorageModule"]).config(["$routeProvider","$compileProvider",function(e,t){e.when("/",{templateUrl:"views/home.html",controller:"HomeCtrl"}).when("/selectTournament",{templateUrl:"views/selecttournament.html",controller:"SelectTournamentCtrl"}).when("/teamNaming",{templateUrl:"views/teamnaming.html",controller:"TeamNamingCtrl"}).when("/manualTeamNaming",{templateUrl:"views/manualteamnaming.html",controller:"ManualTeamNamingCtrl"}).when("/groups",{templateUrl:"views/groups.html",controller:"GroupsCtrl"}).when("/playoffs/:round",{templateUrl:"views/playoffs.html",controller:"PlayoffsCtrl"}).when("/tables/:showButton",{templateUrl:"views/tables.html",controller:"TablesCtrl"}).when("/winner",{templateUrl:"views/winner.html",controller:"WinnerCtrl"}).when("/scorers",{templateUrl:"views/scorers.html",controller:"ScorersCtrl"}).when("/faq",{templateUrl:"views/faq.html"}).when("/rules",{templateUrl:"views/rules.html"}).when("/history",{templateUrl:"views/history.html"}).otherwise({redirectTo:"/"}),t.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|chrome-extension):|data:image\//)}]);
"use strict";angular.module("beerPongTournamentApp").controller("HomeCtrl",["$scope","localStorageService",function(t,e){t.isTournamentPlaying=e.get("tournamentSettings"),t.lastTournamentPath=e.get("tournamentPath")}]);
"use strict";angular.module("beerPongTournamentApp").controller("SelectTournamentCtrl",["$scope","$location","GroupEngine","Tournament","constants",function(e,r,n,a,o){var t,u;a.clearSettings(),e.callAlgo=function(r){t=r,e.showPlayoffs=!1;var a=n.getGroupFromNumberOfPlayers(r);e.groupsSelect=[];for(var u=0,f=a.length;f>u;u++)for(var s=0,p=a[u].configurations.length;p>s;s++)if(a[u].configurations[s].directTournament)e.groupsSelect.push({separator:"team of "+a[u].numberOfPlayers,value:"Tournament from "+o.PLAYOFF_NAME[a[u].configurations[s].step],directTournament:1,step:a[u].configurations[s].step,playersPerTeam:a[u].numberOfPlayers,numberOfTeams:+Math.pow(2,1+a[u].configurations[s].step)});else{var i=[];1===a[u].configurations[s].nbrOfGroups&&i.push({step:-1,value:"simple championship"});for(var m=0,l=a[u].configurations[s].playOffStepMin.length;l>m;m++)i.push({step:a[u].configurations[s].playOffStepMin[m],value:o.PLAYOFF_NAME[a[u].configurations[s].playOffStepMin[m]]});e.groupsSelect.push({separator:"team of "+a[u].numberOfPlayers,playersPerTeam:a[u].numberOfPlayers,value:a[u].configurations[s].nbrOfGroups+" group(s) of "+a[u].configurations[s].nbrOfTeam+" teams",playOffStepMin:a[u].configurations[s].playOffStepMin,playoffs:i,nbrOfGroups:a[u].configurations[s].nbrOfGroups,numberOfTeams:a[u].configurations[s].nbrOfTeam})}},e.getConfigFromNumberOfTeam=function(r){u=r;var a=n.getConfigsFromNumberOfTeams(r);e.configurationsManual=[];for(var t=0,f=a.length;f>t;t++)if(a[t].directTournament)e.configurationsManual.push({value:"Tournament from "+o.PLAYOFF_NAME[a[t].step],directTournament:1,step:a[t].step,numberOfTeams:r});else{var s=[];1===a[t].nbrOfGroups&&s.push({step:-1,value:"simple championship"});for(var p=0,i=a[t].playOffStepMin.length;i>p;p++)s.push({step:a[t].playOffStepMin[p],value:o.PLAYOFF_NAME[a[t].playOffStepMin[p]]});e.configurationsManual.push({value:a[t].nbrOfGroups+" group(s) of "+a[t].nbrOfTeam+" teams",playOffStepMin:a[t].playOffStepMin,playoffs:s,nbrOfGroups:a[t].nbrOfGroups,numberOfTeams:a[t].nbrOfTeam})}},e.goManualTeamNaming=function(e,n,o){a.clearSettings();var t={numberOfGroups:e.nbrOfGroups,numberOfTeamsPerGroup:e.numberOfTeams,playoffStepAfterGroup:n?n.step:void 0,isDirectTournament:e.directTournament,directTournamentStep:e.step,numberOfCupsToWin:o};a.init(t),r.path("/manualTeamNaming")},e.goNextStep=function(e,n,o){var u={numberOfPlayers:t,numberOfGroups:e.nbrOfGroups,numberOfTeamsPerGroup:e.numberOfTeams,numberOfPlayerPerTeam:e.playersPerTeam,playoffStepAfterGroup:n?n.step:void 0,isDirectTournament:e.directTournament,directTournamentStep:e.step,numberOfCupsToWin:o};a.init(u),r.path("/teamNaming")}}]);
"use strict";angular.module("beerPongTournamentApp").controller("TeamNamingCtrl",["$scope","$location","Tournament",function(r,a,e){function t(r){for(var a,e,t=r.length;0!==t;)e=Math.floor(Math.random()*t),t-=1,a=r[t],r[t]=r[e],r[e]=a;return r}var o,s=e.getNumberOfGroups(),n=e.getNumberOfTeamsPerGroup(),m=e.getNumberOfPlayerPerTeam(),p=e.isADirectTournament(),u=[],l=1,f=1;if(p){o={name:"Direct Tournament",teams:[]};for(var h=0;n>h;h++){o.teams.push({name:"Team "+l++,players:[]});for(var g=0;m>g;g++)f++,o.teams[h].players.push({name:"Player "+f,id:f})}u.push(o),r.groups=u}else for(var v=0,c=s;c>v;v++){o={name:"GROUP "+String.fromCharCode(65+v),teams:[]};for(var i=0,y=n;y>i;i++){o.teams.push({name:"Team "+l++,players:[]});for(var T=0,P=m;P>T;T++)o.teams[i].players.push({name:"Player "+f++,id:f})}u.push(o),r.groups=u}r.startTournament=function(){e.setTeams(r.groups),a.path(p?"/playoffs/0":"/groups")},r.switchPlayers=function(r){for(var a=[],e=0,o=r.teams.length;o>e;e++){var s=r.teams[e];a=a.concat(s.players)}t(a);for(var e=0,o=r.teams.length;o>e;e++){var s=r.teams[e];s.players=[];for(var n=0;m>n;n++)s.players.push(a.pop())}},r.random=function(){for(var a=[],e=0,o=u.length;o>e;e++)for(var s=0,n=u[e].teams.length;n>s;s++){var p=u[e].teams[s];a=a.concat(p.players)}t(a);for(var e=0,o=u.length;o>e;e++)for(var s=0,n=u[e].teams.length;n>s;s++){var p=u[e].teams[s];p.players=[];for(var l=0;m>l;l++)p.players.push(a.pop())}r.groups=u},r.switchTeam=function(){for(var a=[],e=0,o=u.length;o>e;e++)a=a.concat(u[e].teams);t(a);for(var e=0,o=u.length;o>e;e++)for(var s=0,n=u[e].teams.length;n>s;s++)u[e].teams[s]=a.pop();r.groups=u}}]);
"use strict";angular.module("beerPongTournamentApp").controller("PlayoffsCtrl",["$scope","$location","$routeParams","Tournament","constants",function(e,s,t,r,a){var n,l=angular.copy(r.getPlayoffs()),o=r.getNumberOfCupsToWin(),u=t.round,g=0,c=0;if(e.nbrOfCupsToWin=o,l[u].result){g=l[u].result.length,n=Math.log(g)/Math.log(2),e.title=a.PLAYOFF_NAME[n],e.games=l[u].result;for(var p=0,h=l[u].result.length;h>p;p++){var i=l[u].result[p];i.winner>-1&&g--}0===g&&(e.showNextStep=!0)}else{for(var f,m,y,v,w=angular.copy(l[u].divisions),P=[],M=0,N=w.length;N/2>M;M++){1===w.length?(f=w[0],m=w[0],y=f.teams.length/2,v=f.teams.length):(f=w[2*M],m=w[2*M+1],y=f.teams.length,v=f.teams.length);for(var p=0;y>p;p++){var d=f.teams[p],A=m.teams[v-p-1];g++;for(var x=[],F=[],O=d.players.length,T=A.players.length,W=0,b=Math.max(O,T);b>W;W++)O>W&&(d.players[W].score=0,x.push(angular.copy(d.players[W]))),T>W&&(A.players[W].score=0,F.push(angular.copy(A.players[W])));P.push({title:d.name+" vs "+A.name,match:[d,A],score:[0,0],scorers:[d.players,A.players],winner:-1,id:c++})}}n=Math.log(g)/Math.log(2),e.title=a.PLAYOFF_NAME[n],e.games=P}e.setWinner=function(s,t){-1===s.winner&&(g--,0===g&&(e.showNextStep=!0)),s.winner=t,l[u].result=e.games,r.setPlayoffs(l)},e.scoreUp=function(s,t,a){t[a]<o&&(t[a]=t[a]+1,s.score=s.score?s.score+1:1,l[u].result=e.games,r.setPlayoffs(l))},e.scoreDown=function(s,t,a,n){s.score>0&&(n.winner===a&&(n.winner=-1,g++),t[a]=t[a]-1,s.score=s.score-1,l[u].result=e.games,r.setPlayoffs(l))},e.goNextStep=function(){l[u].result=e.games;for(var t=[],a=parseInt(u)+1,n=0,g=l[u].result.length;g>n;n++)t.push(l[u].result[n].score[0]===o?l[u].result[n].match[0]:l[u].result[n].match[1]);l.push({divisions:[{teams:t}]}),r.setPlayoffs(l),t.length>1?s.path("/playoffs/"+a):(r.setWinner(t[0]),s.path("/winner"))}}]);
"use strict";angular.module("beerPongTournamentApp").controller("GroupsCtrl",["$scope","$location","Tournament",function(r,e,s){function o(r,e,s){for(var o=0,t=r.length;t>o;o++)r[o]=o===e[0]||o===e[1]?0:r[o]+1;for(var n=0,u=s.length;u>n;n++)s[n].priority=r[s[n].match[0]]+r[s[n].match[1]];s.sort(function(r,e){return e.priority-r.priority})}var t=s.getNumberOfCupsToWin(),n=0,u=0;if(r.nbrOfCupsToWin=t,r.showNextStep=!1,s.getGroupsResult()){r.numberOfGamesTotal=0;var a=s.getGroupsResult();r.groups=a;for(var p=0,l=a.length;l>p;p++)for(var h=0,f=a[p].rounds.length;f>h;h++)for(var i=0,c=a[p].rounds[h].length;c>i;i++)a[p].rounds[h][i].winner<0&&n++,r.numberOfGamesTotal++;r.numberOfGames=n,0===n&&(r.showNextStep=!0)}else{for(var g=[],m=s.getTeams(),v=0,G=m.length;G>v;v++){for(var y=m[v],b=m[v].teams,w=b.length,O=[],T=[],d=0,R=b.length;R>d;d++)T.push(0);for(var x=1,N=b.length;N>x;x++)for(var S=0;x-1>=S;S++){for(var C=[],W=[],M=b[x].players.length,$=b[S].players.length,h=0,f=Math.max(M,$);f>h;h++)M>h&&(b[x].players[h].score=0,C.push(angular.copy(b[x].players[h]))),$>h&&(b[S].players[h].score=0,W.push(angular.copy(b[S].players[h])));O.push({priority:0,match:[x,S],title:b[x].name+" vs "+b[S].name,score:[0,0],scorers:[C,W],winner:-1,id:u++})}for(n+=O.length,r.numberOfGamesTotal=n,y.rounds=[];O.length>0;){for(var A=[],D=0,P=Math.floor(w/2);P>D;D++){var U=O.shift();A.push(U),o(T,U.match,O)}y.rounds.push(A)}g.push(y)}r.groups=g,s.setGroupsResult(r.groups)}r.setWinner=function(e,o){-1===e.winner&&(n--,r.numberOfGames=n,0===n&&(r.showNextStep=!0)),e.winner=o,s.setGroupsResult(r.groups)},r.scoreUp=function(e,o,n){o[n]<t&&(o[n]=o[n]+1,e.score=e.score?e.score+1:1,s.setGroupsResult(r.groups))},r.scoreDown=function(e,o,t,u){e.score>0&&(u.winner===t&&(u.winner=-1,n++,r.numberOfGames=n),o[t]=o[t]-1,e.score=e.score-1,s.setGroupsResult(r.groups))},r.goNextStep=function(){s.setGroupsResult(r.groups),e.path("/tables/1")}}]);
"use strict";angular.module("beerPongTournamentApp").controller("TablesCtrl",["$scope","$routeParams","$location","Tournament",function(e,a,t,r){var o=r.getPlayoffStepAfterGroup(),n=r.getTables(),s=r.getTeams(),f=(r.getPlayoffs(),parseInt(a.showButton));if(e.showButton=f,e.tables=n,o>-1){var u=r.getNumberOfGroups(),l=Math.pow(2,o+1)/u;if(e.numberOfTeamsQualifiedPerGroups=l,f){for(var m=[],p=angular.copy(s),i=0;i<n.length;i++){for(var g=[],b=0;l>b;b++)for(var h=p[i].teams.length;h--;)if(p[i].teams[h].name===n[i].table[b].name){g.push(p[i].teams[h]);break}m.push({teams:g})}r.setTeamsQualifiedForPlayoff(m),e.goNextStep=function(){t.path("/playoffs/0")}}}else{e.numberOfTeamsQualifiedPerGroups=1;for(var c=n[0].table[0],p=angular.copy(s),h=p[0].teams.length;h--;)if(p[0].teams[h].name===c.name){r.setWinner(p[0].teams[h]);break}e.goNextStep=function(){t.path("/winner")}}}]);
"use strict";angular.module("beerPongTournamentApp").controller("WinnerCtrl",["$scope","Tournament",function(e,n){e.winner=n.getWinner(),e.scorers=n.getScorers(),console.log("playoffs",n.getPlayoffs())}]);
"use strict";angular.module("beerPongTournamentApp").controller("HeaderCtrl",["$scope","$location","Tournament","localStorageService",function(e,t,n,o){var a=t.url();e.goTournament=o.get("tournamentPath"),e.isOpen=!1,e.iconActive=-1,"/tables/0"===a?e.iconActive=1:"/scorers"===a?e.iconActive=2:(o.set("tournamentPath","#"+a),e.goTournament="#"+a,e.iconActive=0),e.displayTablesButton=n.getTables(),e.displayScorersButton=n.getTeams(),e.toggleMenu=function(){e.isOpen=!e.isOpen}}]);
"use strict";angular.module("beerPongTournamentApp").controller("ScorersCtrl",["$scope","Tournament",function(e,r){e.scorers=r.getScorers();for(var t=r.getTeams(),a=[],n=[],o=0,s=t.length;s>o;o++){var l=t[o];a.push(l.name);for(var m=0,u=l.teams.length;u>m;m++){var c=l.teams[m];n.push(c.name)}}e.filterTypes=[a,n]}]);
"use strict";angular.module("beerPongTournamentApp").controller("ManualTeamNamingCtrl",["$scope","$location","Tournament",function(e,r,a){var n,s=a.getNumberOfGroups(),m=a.getNumberOfTeamsPerGroup(),o=a.isADirectTournament(),t=[],u=1,p=1,l=1;if(e.playersMinimum=s*m,o){n={name:"Direct Tournament",teams:[]};for(var i=0;m>i;i++)n.teams.push({name:"Team "+u++,players:[]});t.push(n),e.groups=t}else for(var f=0,y=s;y>f;f++){n={name:"GROUP "+String.fromCharCode(65+f),teams:[]};for(var g=0,c=m;c>g;g++)n.teams.push({name:"Team "+u++,players:[]});t.push(n),e.groups=t}e.addPlayer=function(r){0===r.players.length&&e.playersMinimum--,r.players.push({name:"Player "+p++,id:l++})},e.removePlayer=function(r,a){for(var n=r.players.length;n--;)if(r.players[n].id===a.id){r.players.splice(n,1);break}0===r.players.length&&e.playersMinimum++},e.startTournament=function(){a.setTeams(e.groups),r.path(o?"/playoffs/0":"/groups")}}]);
"use strict";angular.module("beerPongTournamentApp").factory("GroupEngine",function(){function r(r){var a=Math.log(r)/Math.log(2);return a===parseInt(a)}function a(a){var o=[];r(a)&&o.push({directTournament:1,step:Math.log(a/2)/Math.log(2)});for(var t=!0,n=0;t;){var u=a/Math.pow(2,n);if(u===parseInt(u)&&u>2){for(var e=Math.pow(2,n),f=a-e,i=Math.floor(Math.log(f)/Math.log(2)),s=Math.pow(2,i),h=!0,p=0,g=[];h;)3>e&&2*Math.pow(2,p)<=s?(g.push(Math.log(Math.pow(2,p))/Math.log(2)),p++):e>2&&e*Math.pow(2,p)<=s?(g.push(Math.log(e*Math.pow(2,p)/2)/Math.log(2)),p++):h=!1;o.push({nbrOfGroups:e,nbrOfTeam:u,playOffStepMin:g}),n++}else t=!1}return o}var o={};return o.getGroupFromNumberOfPlayers=function(r){var o=[];if(r>1){var t={numberOfPlayers:1,configurations:[]};t.configurations=a(r),o.push(t)}if(r%2===0&&r>4){var n={numberOfPlayers:2,configurations:[]};n.configurations=a(r/2),o.push(n)}if(r%3===0&&r>6){var u={numberOfPlayers:3,configurations:[]};u.configurations=a(r/3),o.push(u)}return o},o.getConfigsFromNumberOfTeams=function(r){var o=a(r);return o},o});
"use strict";angular.module("beerPongTournamentApp").service("Tournament",["localStorageService",function(e){function r(e,r,n,t,s){for(var i=e.length;i--;)if(e[i].name===r){"win"===n?e[i].win+=1:"lose"===n&&(e[i].lose+=1),e[i].cupsFor+=t,e[i].cupsAgainst+=s;break}}function n(e,r,n,t){for(var s=e.length;s--;)if(e[s].id===r){e[s].score+=n,e[s].numberOfGame+=1,e[s].win+=+t;break}}var t=e.get("tournamentSettings")||!1,s=e.get("teams")||!1,i=e.get("groupResult")||!1,o=e.get("playoffs")||!1,a=e.get("winner")||!1;this.clearSettings=function(){e.clearAll(),a=t=s=i=o=!1},this.init=function(r){e.set("tournamentSettings",r),t=r},this.isADirectTournament=function(){return t.isDirectTournament},this.getNumberOfGroups=function(){return t.numberOfGroups},this.getDirectTournamentStep=function(){return t.directTournamentStep},this.getNumberOfTeamsPerGroup=function(){return t.numberOfTeamsPerGroup},this.getNumberOfPlayerPerTeam=function(){return t.numberOfPlayerPerTeam},this.setTeams=function(r){s=r,e.set("teams",r)},this.getTeams=function(){return s},this.setTeamsQualifiedForPlayoff=function(r){o=[{divisions:r}],e.set("playoffs",o)},this.setPlayoffs=function(r){e.set("playoffs",r),o=r},this.getPlayoffs=function(){return o?o:[{divisions:[{teams:s[0].teams}]}]},this.getNumberOfCupsToWin=function(){return t.numberOfCupsToWin},this.getPlayoffStepAfterGroup=function(){return t.playoffStepAfterGroup},this.getGroupsResult=function(){return i},this.setGroupsResult=function(r){e.set("groupResult",r),i=r},this.setWinner=function(r){e.set("winner",r),a=r},this.getWinner=function(){return a},this.getTables=function(){for(var e=[],n=0,t=i.length;t>n;n++){for(var s={name:i[n].name,table:[]},o=0,a=i[n].teams.length;a>o;o++){var u={name:i[n].teams[o].name,win:0,lose:0,cupsFor:0,cupsAgainst:0};s.table.push(u)}for(var f=0,c=i[n].rounds.length;c>f;f++)for(var l=0,m=i[n].rounds[f].length;m>l;l++){var g=i[n].rounds[f][l];if(g.winner>-1){var h=g.winner,p=+!g.winner;r(s.table,i[n].teams[g.match[h]].name,"win",g.score[h],g.score[p]),r(s.table,i[n].teams[g.match[p]].name,"lose",g.score[p],g.score[h])}}s.table.sort(function(e,r){if(r.win===e.win){var n=e.cupsFor-e.cupsAgainst,t=r.cupsFor-r.cupsAgainst;return t===n?e.cupsFor-r.cupsFor:t-n}return r.win-e.win}),e.push(s)}return e},this.getScorers=function(){for(var e=[],r=0,t=s.length;t>r;r++)for(var u=s[r],f=s[r].name,c=0,l=u.teams.length;l>c;c++)for(var m=s[r].teams[c],g=s[r].teams[c].name,h=0,p=m.players.length;p>h;h++){var v=m.players[h];v.score=0,v.numberOfGame=0,v.groupName=f,v.teamName=g,v.win=0,v.winner=a&&a.name===g?1:0,e.push(v)}if(i)for(var r=0,t=i.length;t>r;r++)for(var u=i[r],c=0,l=u.rounds.length;l>c;c++)for(var w=u.rounds[c],h=0,p=w.length;p>h;h++){var b=w[h];if(b.winner>-1)for(var T=b.scorers[0].length,d=b.scorers[1].length,y=0,P=Math.max(T,d);P>y;y++){if(T>y){var G=b.scorers[0][y];n(e,G.id,G.score,0===b.winner)}if(d>y){var O=b.scorers[1][y];n(e,O.id,O.score,1===b.winner)}}}if(o)for(var r=0,t=o.length;t>r;r++){var S=o[r];if(S.result)for(var c=0,l=S.result.length;l>c;c++){var b=S.result[c];if(b.winner>-1)for(var T=b.scorers[0].length,d=b.scorers[1].length,y=0,P=Math.max(T,d);P>y;y++){if(T>y){var G=b.scorers[0][y];n(e,G.id,G.score,0===b.winner)}if(d>y){var O=b.scorers[1][y];n(e,O.id,O.score,1===b.winner)}}}}return e.sort(function(e,r){return r.score-e.score}),e}}]);
"use strict";angular.module("beerPongTournamentApp").constant("constants",{PLAYOFF_NAME:["final","semi-final","quarter-final","16nd round","32nd round","64nd round","128 nd round","256 nd round","512 nd round"]});
"use strict";angular.module("beerPongTournamentApp").filter("scorers",function(){return function(r,e,n){if(0>e||e>-1&&!n)return r;if(0==e){for(var t=[],u=0,o=r.length;o>u;u++)r[u].groupName===n&&t.push(r[u]);return t}for(var t=[],u=0,o=r.length;o>u;u++)r[u].teamName===n&&t.push(r[u]);return t}});
"use strict";angular.module("beerPongTournamentApp").directive("progressbar",function(){return{restrict:"E",template:'<div class="progressbar"><div>{{current}}/{{total}}</div></div>',replace:!0,scope:{total:"=",current:"="},link:function(r,t){var e=angular.element(t.children());r.$watch("current",function(t){e.css("width",t/r.total*100+"%")})}}});